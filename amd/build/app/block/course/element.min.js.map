{"version":3,"file":"element.min.js","sources":["../../../../src/app/block/course/element.js"],"sourcesContent":["// eslint-disable-next-line no-unused-vars\nimport BaseFactory from '../factory';\nimport Templates from \"core/templates\";\n\nexport default class CourseElement {\n    /**\n     * @type {BaseFactory}\n     */\n    #baseFactory;\n\n    /**\n     * @type {BlockElement}\n     */\n    #blockElement;\n\n    /**\n     * @type {HTMLElement}\n     */\n    #element;\n\n    /**\n     * @type {HTMLElement|null}\n     */\n    #clipboard = null;\n\n    constructor(baseFactory, blockElement, element) {\n        this.#baseFactory = baseFactory;\n        this.#blockElement = blockElement;\n        this.#element = element;\n    }\n\n    async addBackupToSharingCartButtons() {\n        let element = document.createElement('div');\n        const {html, js} = await new Promise((resolve, reject) => {\n            Templates.render('block_sharing_cart/block/course/add_to_sharing_cart_button', {})\n                .then(async (html, js) => {\n                    resolve({\n                        html,\n                        js\n                    });\n                }).fail(reject);\n        });\n        element = await Templates.replaceNode(\n            element,\n            html,\n            js\n        )[0];\n\n        const sectionTitles = this.#element.querySelectorAll('.course-section-header .inplaceeditable');\n        sectionTitles.forEach((sectionTitle) => {\n            const button = element.cloneNode(true);\n\n            sectionTitle.after(button);\n        });\n\n        this.#element.querySelectorAll('.cm_action_menu').forEach((courseModuleActionMenu) => {\n            const button = element.cloneNode(true);\n\n            courseModuleActionMenu.append(button);\n        });\n    }\n\n    async renderClipboard() {\n        this.#clipboard = document.createElement('div');\n\n        const {html, js} = await new Promise((resolve, reject) => {\n            Templates.render('block_sharing_cart/block/course/clipboard', {})\n                .then(async (html, js) => {\n                    resolve({\n                        html,\n                        js\n                    });\n                }).fail(reject);\n        });\n        this.#clipboard = await Templates.replaceNode(\n            this.#clipboard,\n            html,\n            js\n        )[0];\n\n        this.#element.prepend(this.#clipboard);\n        this.#clipboard.querySelector('[data-action=\"clear-clipboard\"]').addEventListener('click', this.clearClipboard.bind(this));\n    }\n\n    /**\n     * @param {Event} e\n     */\n    clearClipboard(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.#clipboard.classList.add('d-none');\n        this.clearClipboardTargets();\n\n        this.#blockElement.clearClipboard();\n    }\n\n    /**\n     * @param {ItemElement} item\n     */\n    updateClipboard(item) {\n        this.#clipboard.classList.add('d-none');\n\n        const clipboardItemInfo = this.#clipboard.querySelector('.info');\n        clipboardItemInfo.innerHTML = item.getItemInfo().innerHTML;\n\n        this.#clipboard.classList.remove('d-none');\n    }\n\n    /**\n     * @param {ItemElement} item\n     */\n    async updateClipboardTargets(item) {\n        let element = document.createElement('div');\n        const {html, js} = await new Promise((resolve, reject) => {\n            Templates.render('block_sharing_cart/block/course/clipboard_target', {})\n                .then(async (html, js) => {\n                    resolve({\n                        html,\n                        js\n                    });\n                }).fail(reject);\n        });\n        element = await Templates.replaceNode(\n            element,\n            html,\n            js\n        )[0];\n\n        this.#element.querySelectorAll('[data-for=\"cmlist\"]').forEach((section) => {\n            const clipboardTarget = section.querySelector('.clipboard_target') ?? element.cloneNode(true);\n\n            section.prepend(clipboardTarget);\n        });\n    }\n\n    getClipboardTargets() {\n        return this.#element.querySelectorAll('.clipboard_target');\n    }\n\n    clearClipboardTargets() {\n        this.getClipboardTargets().forEach((target) => {\n            target.remove();\n        });\n    }\n\n    /**\n     * @param {ItemElement} item\n     */\n    async setClipboard(item) {\n        if (!this.#clipboard) {\n            await this.renderClipboard();\n        }\n\n        this.updateClipboard(item);\n        await this.updateClipboardTargets(item);\n    }\n}"],"names":["constructor","baseFactory","blockElement","element","document","createElement","html","js","Promise","resolve","reject","render","then","async","fail","Templates","replaceNode","_classPrivateFieldGet","querySelectorAll","forEach","sectionTitle","button","cloneNode","after","courseModuleActionMenu","append","this","prepend","querySelector","addEventListener","clearClipboard","bind","e","preventDefault","stopPropagation","classList","add","clearClipboardTargets","updateClipboard","item","innerHTML","getItemInfo","remove","section","clipboardTarget","getClipboardTargets","target","renderClipboard","updateClipboardTargets"],"mappings":"khDAyBIA,YAAYC,YAAaC,aAAcC,+RAF1B,+CAGWF,sDACCC,kDACLC,mDAIZA,QAAUC,SAASC,cAAc,aAC/BC,KAACA,KAADC,GAAOA,UAAY,IAAIC,SAAQ,CAACC,QAASC,6BACjCC,OAAO,6DAA8D,IAC1EC,MAAKC,MAAOP,KAAMC,MACfE,QAAQ,CACJH,KAAAA,KACAC,GAAAA,QAELO,KAAKJ,WAEhBP,cAAgBY,mBAAUC,YACtBb,QACAG,KACAC,IACF,GAEoBU,qCAAcC,iBAAiB,2CACvCC,SAASC,qBACbC,OAASlB,QAAQmB,WAAU,GAEjCF,aAAaG,MAAMF,gDAGTH,iBAAiB,mBAAmBC,SAASK,+BACjDH,OAASlB,QAAQmB,WAAU,GAEjCE,uBAAuBC,OAAOJ,yEAKhBjB,SAASC,cAAc,cAEnCC,KAACA,KAADC,GAAOA,UAAY,IAAIC,SAAQ,CAACC,QAASC,6BACjCC,OAAO,4CAA6C,IACzDC,MAAKC,MAAOP,KAAMC,MACfE,QAAQ,CACJH,KAAAA,KACAC,GAAAA,QAELO,KAAKJ,uDAEQK,mBAAUC,kCAC9BU,iBACApB,KACAC,IACF,yCAEYoB,8BAAQD,yDACNE,cAAc,mCAAmCC,iBAAiB,QAASH,KAAKI,eAAeC,KAAKL,OAMxHI,eAAeE,GACXA,EAAEC,iBACFD,EAAEE,yDAEcC,UAAUC,IAAI,eACzBC,kEAEcP,iBAMvBQ,gBAAgBC,6CACIJ,UAAUC,IAAI,UAEJnB,uCAAgBW,cAAc,SACtCY,UAAYD,KAAKE,cAAcD,iDAEjCL,UAAUO,OAAO,uCAMRH,UACrBpC,QAAUC,SAASC,cAAc,aAC/BC,KAACA,KAADC,GAAOA,UAAY,IAAIC,SAAQ,CAACC,QAASC,6BACjCC,OAAO,mDAAoD,IAChEC,MAAKC,MAAOP,KAAMC,MACfE,QAAQ,CACJH,KAAAA,KACAC,GAAAA,QAELO,KAAKJ,WAEhBP,cAAgBY,mBAAUC,YACtBb,QACAG,KACAC,IACF,wCAEYW,iBAAiB,uBAAuBC,SAASwB,0CACrDC,8CAAkBD,QAAQf,cAAc,4EAAwBzB,QAAQmB,WAAU,GAExFqB,QAAQhB,QAAQiB,oBAIxBC,6BACW5B,qCAAcC,iBAAiB,qBAG1CmB,6BACSQ,sBAAsB1B,SAAS2B,SAChCA,OAAOJ,+BAOIH,4BACVb,wBACKA,KAAKqB,uBAGVT,gBAAgBC,YACfb,KAAKsB,uBAAuBT"}